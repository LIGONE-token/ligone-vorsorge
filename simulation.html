<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Virtuelle Vorsorge erleben | LIGONE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="description"
        content="Erlebe finanzielle Vorsorge virtuell – ohne Risiko, ohne Einzahlung.">

  <link rel="stylesheet" href="assets/style.css">
</head>
<body>

<main class="simulation">

  <h1>Virtuelle Vorsorge erleben</h1>

  <p class="intro">
    Diese Simulation zeigt, wie sich langfristige Vorsorge mit kleinen,
    regelmäßigen Beträgen anfühlen kann.
    <br><strong>Kein Echtgeld. Keine Anlageberatung.</strong>
  </p>

  <!-- BETRAGSAUSWAHL -->
  <section class="amount-select">
    <h2>Monatlicher Vorsorgebetrag</h2>

    <div class="amount-buttons">
      <button data-amount="5">5 €</button>
      <button data-amount="10" class="active">10 €</button>
      <button data-amount="20">20 €</button>
      <button data-amount="50">50 €</button>
    </div>

    <p class="hint">
      Wähle einen Betrag, den du dir langfristig vorstellen kannst.
    </p>
  </section>

  <!-- DASHBOARD -->
  <section class="dashboard">
    <div class="card">
      <span class="label">Virtuelle Einzahlungen</span>
      <strong id="totalPaid">0 €</strong>
    </div>

    <div class="card">
      <span class="label">Virtueller Wert heute</span>
      <strong id="currentValue">0 €</strong>
    </div>

    <div class="card">
      <span class="label">Zeitraum</span>
      <strong id="months">0 Monate</strong>
    </div>
  </section>

  <!-- MARKTPREISE -->
<section class="market-box">
  <div>Preis heute: <strong id="priceToday">–</strong></div>
  <div>Preis gestern: <strong id="priceYesterday">–</strong></div>
  <div>Veränderung: <strong id="priceChange">–</strong></div>
</section>



  <!-- ZEITSTEUERUNG -->
  <section class="time-control">
    <h2>Zeitraum simulieren</h2>

    <input type="range" min="1" max="240" value="12" id="timeRange">
    <div class="range-label">
      <span>1 Monat</span>
      <span>20 Jahre</span>
    </div>
  </section>

  <!-- HINWEIS -->
  <section class="notice">
    <p>
      Diese Darstellung ist eine <strong>Simulation</strong>.
      Sie zeigt keine Prognose und kein Renditeversprechen.
      Sie dient ausschließlich dem Verständnis von Zeit, Beständigkeit
      und Vorsorge.
    </p>
  </section>

</main>

<script>
/* ====== BASISPARAMETER ====== */
let monthlyAmount = 10;
let months = 12;

/* Ruhiger Referenzfaktor (keine Rendite-Aussage!) */
const referenceFactor = 1.15; // rein illustrativ

/* ====== ELEMENTE ====== */
const totalPaidEl = document.getElementById("totalPaid");
const currentValueEl = document.getElementById("currentValue");
const monthsEl = document.getElementById("months");
const timeRange = document.getElementById("timeRange");
const buttons = document.querySelectorAll(".amount-buttons button");

/* ====== FUNKTION ====== */
function updateSimulation() {
  const totalPaid = monthlyAmount * months;
  const simulatedValue = totalPaid * referenceFactor;

  totalPaidEl.textContent = totalPaid.toLocaleString("de-DE") + " €";
  currentValueEl.textContent = simulatedValue.toLocaleString("de-DE") + " €";
  monthsEl.textContent = months + " Monate";
}

/* ====== EVENTS ====== */
buttons.forEach(btn => {
  btn.addEventListener("click", () => {
    buttons.forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    monthlyAmount = Number(btn.dataset.amount);
    updateSimulation();
  });
});

timeRange.addEventListener("input", e => {
  months = Number(e.target.value);
  updateSimulation();
});

/* INIT */
updateSimulation();
</script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const SUPABASE_URL = "https://thrdlycfwlsegriduqvw.supabase.co";
const SUPABASE_ANON_KEY = "sb_publishable_JHb4LBhP26eI7BgDS1jIkw_4OYn3-F9";

const supabase = supabaseJs.createClient(
  SUPABASE_URL,
  SUPABASE_ANON_KEY
);

async function loadMarketPrices() {
  const { data, error } = await supabase
    .from("ligone_prices")
    .select("date, price_eur")
    .order("date", { ascending: false })
    .limit(2);

  if (error || !data || data.length === 0) {
    console.error("Preise konnten nicht geladen werden");
    return;
  }

  const today = data[0];
  const yesterday = data[1] || data[0];

  const diff = today.price_eur - yesterday.price_eur;
  const diffPct = yesterday.price_eur
    ? (diff / yesterday.price_eur) * 100
    : 0;

  document.getElementById("priceToday").textContent =
    today.price_eur.toFixed(8) + " €";

  document.getElementById("priceYesterday").textContent =
    yesterday.price_eur.toFixed(8) + " €";

  document.getElementById("priceChange").textContent =
    (diff >= 0 ? "+" : "") +
    diff.toFixed(8) + " € (" +
    diffPct.toFixed(2) + "%)";
}

loadMarketPrices();
</script>

</body>
</html>
